#include "pch.hpp"
#include "Cell.hpp"


namespace world {
    constexpr static inline uint32_t toInt(Cell::Type type) {
        return static_cast<uint32_t>(type);
    }

    Cell const *Cell::byType(Cell::Type type) {
        return &(cells[static_cast<size_t>(type)]);
    }

    constexpr Cell Cell::cells[4] = {
        {toInt(Cell::Type::Air), "air", 0, false},
        {toInt(Cell::Type::Stone), "stone", 0, true},
        {toInt(Cell::Type::Door), "door", 81, false},
        {toInt(Cell::Type::Grate), "grate", 82, false}
    };

    constexpr uint8_t Cell::connections[256] = {
        19, 19, 67, 67, 19, 19, 67, 67, 16, 16, 68, 64, 16, 16, 68, 64,
        18, 18, 71, 71, 18, 18, 66, 66, 17, 17, 72, 70, 17, 17, 69, 65,
        19, 19, 67, 67, 19, 19, 67, 67, 16, 16, 68, 64, 16, 16, 68, 64,
        18, 18, 71, 71, 18, 18, 66, 66, 17, 17, 72, 70, 17, 17, 69, 65,
        35, 35, 51, 51, 35, 35, 51, 51, 20, 20,  4, 36, 20, 20,  4, 36,
        23, 23,  7,  7, 23, 23, 39, 39, 24, 24,  8, 41, 24, 24, 42, 40,
        35, 35, 51, 51, 35, 35, 51, 51, 32, 32, 52, 48, 32, 32, 52, 48,
        23, 23,  7,  7, 23, 23, 39, 39, 22, 22, 26,  6, 22, 22, 57, 38,
        19, 19, 67, 67, 19, 19, 67, 67, 16, 16, 68, 64, 16, 16, 68, 64,
        18, 18, 71, 71, 18, 18, 66, 66, 17, 17, 72, 70, 17, 17, 69, 65,
        19, 19, 67, 67, 19, 19, 67, 67, 16, 16, 68, 64, 16, 16, 68, 64,
        18, 18, 71, 71, 18, 18, 66, 66, 17, 17, 72, 70, 17, 17, 69, 65,
        35, 35, 51, 51, 35, 35, 51, 51, 20, 20,  4, 36, 20, 20,  4, 36,
        34, 34, 55, 55, 34, 34, 50, 50, 21, 21, 27, 73, 21, 21,  5, 37,
        35, 35, 51, 51, 35, 35, 51, 51, 32, 32, 52, 48, 32, 32, 52, 48,
        34, 34, 55, 55, 34, 34, 50, 50, 33, 33, 56, 54, 33, 33, 53, 49
    };

    std::ostream &operator<<(std::ostream &os, const Cell &cell) {
        os << cell.name;
        return os;
    }
}
